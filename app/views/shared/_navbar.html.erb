<nav class="navbar navbar--stacked" id="site-navbar">
  <!-- Floating hamburger button (mobile only via CSS) -->
  <button
    class="hamburger-btn"
    id="hamburger-btn"
    type="button"
    aria-label="Open menu"
    aria-controls="mobile-menu"
    aria-expanded="false"
  >
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div class="nav-stack">
    <a href="/" class="brand brand-logo" aria-label="VandalSquat home">
      <%= image_tag "vandalsquat-logo.png",
            alt: "VandalSquat",
            class: "brand-img",
            loading: "eager" %>
    </a>

    <div class="nav-center" id="mobile-menu">
      <a href="/">Home</a>
      <a href="/entries">Entries</a>
      <a href="/account">My Account</a>

      <% if logged_in? %>
        <%= button_to "Log out",
              logout_path,
              method: :delete,
              class: "logout-btn-inline",
              form: { class: "logout-form-inline" } %>
      <% else %>
        <a href="/login">Login</a>
      <% end %>
    </div>
  </div>

  <div class="nav-overlay" id="nav-overlay"></div>
</nav>

<script>
  (function () {
    const nav = document.getElementById("site-navbar");
    const btn = document.getElementById("hamburger-btn");
    const overlay = document.getElementById("nav-overlay");
    const menu = document.getElementById("mobile-menu");

    if (!nav || !btn || !overlay || !menu) return;

    function openMenu() {
      nav.classList.add("is-open");
      btn.classList.add("active");
      btn.setAttribute("aria-expanded", "true");
      document.body.style.overflow = "hidden";
    }

    function closeMenu() {
      nav.classList.remove("is-open");
      btn.classList.remove("active");
      btn.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    }

    btn.addEventListener("click", () => {
      nav.classList.contains("is-open") ? closeMenu() : openMenu();
    });

    overlay.addEventListener("click", closeMenu);

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeMenu();
    });

    menu.querySelectorAll("a").forEach(a => a.addEventListener("click", closeMenu));
  })();
</script>
